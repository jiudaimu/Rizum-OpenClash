# =====================
# åŸºç¡€å…¨å±€é…ç½®
# =====================
port: 7890                     # HTTPä»£ç†ç«¯å£
socks-port: 7891               # SOCKS5ä»£ç†ç«¯å£
allow-lan: true                # å…è®¸å±€åŸŸç½‘è¿æ¥
mode: Rule                     # è§„åˆ™æ¨¡å¼
log-level: info                # æ—¥å¿—çº§åˆ«
external-controller: 0.0.0.0:9090  # æ§åˆ¶å°è®¿é—®åœ°å€
ipv6: true                     # å¯ç”¨IPv6æ”¯æŒ

# =====================
# èŠ‚ç‚¹è®¢é˜…é…ç½®
# =====================
proxy-providers:
  MyAirport:
    type: http
    url: "{{SUB_URL}}"  # æ›¿æ¢ä¸ºæ‚¨çš„HTTPSè®¢é˜…åœ°å€
    path: ./providers/airport.yaml
    interval: 86400            # 24å°æ—¶æ›´æ–°ä¸€æ¬¡
    health-check:
      enable: true
      interval: 600            # 10åˆ†é’Ÿå¥åº·æ£€æŸ¥
      url: https://www.gstatic.com/generate_204  # HTTPSæ£€æŸ¥åœ°å€

# =====================
# ç­–ç•¥ç»„é…ç½®
# =====================
proxy-groups:
  - name: ğŸš€ è‡ªåŠ¨ä»£ç†
    type: url-test             # è‡ªåŠ¨é€‰æ‹©å»¶è¿Ÿæœ€ä½èŠ‚ç‚¹
    url: https://www.gstatic.com/generate_204
    interval: 300              # 5åˆ†é’Ÿæµ‹è¯•ä¸€æ¬¡
    proxies:
      - provider:MyAirport     # ä½¿ç”¨æœºåœºè®¢é˜…èŠ‚ç‚¹
    filter: "é¦™æ¸¯|å°æ¹¾|å›å›½"    # ä»…ä¿ç•™æ¸¯å°å’Œå›½å†…èŠ‚ç‚¹

  - name: ğŸµ ç½‘æ˜“äº‘éŸ³ä¹
    type: select               # æ‰‹åŠ¨é€‰æ‹©ä»£ç†
    proxies:
      - provider:MyAirport     # ä»æœºåœºè®¢é˜…é€‰æ‹©èŠ‚ç‚¹
      - DIRECT                 # ç›´è¿é€‰é¡¹

  - name: ğŸ“º å›½å†…æµåª’ä½“
    type: select
    proxies:
      - DIRECT                 # é»˜è®¤ç›´è¿
      - ğŸš€ è‡ªåŠ¨ä»£ç†            # å¤‡ç”¨ä»£ç†

  - name: ğŸ® VRChatä¸“ç”¨
    type: select
    proxies:
      - ğŸš€ è‡ªåŠ¨ä»£ç†            # æŒ‡å®šä»£ç†èŠ‚ç‚¹
      - DIRECT                 # ç›´è¿é€‰é¡¹

  - name: ğŸ  å›½å†…ç›´è¿
    type: select
    proxies:
      - DIRECT                 # ç›´è¿æ¨¡å¼
      - REJECT                 # æ‹’ç»æ¨¡å¼

# =====================
# è§„åˆ™é…ç½®
# =====================
rules:
  # ä¼˜å…ˆå¤„ç†ç‰¹æ®Šè§„åˆ™
  - DOMAIN,bil.ouo.chat,ğŸ® VRChatä¸“ç”¨       # VRChat BiliPlayeråŸŸå1
  - DOMAIN,biliplayer.91vrchat.com,ğŸ® VRChatä¸“ç”¨  # VRChat BiliPlayeråŸŸå2

  # æµåª’ä½“è§„åˆ™
  - DOMAIN-SUFFIX,music.163.com,ğŸµ ç½‘æ˜“äº‘éŸ³ä¹  # ç½‘æ˜“äº‘å•ç‹¬å¤„ç†
  - RULE-SET,bilibili,ğŸ“º å›½å†…æµåª’ä½“          # Bç«™å…¨å®¶æ¡¶
  - RULE-SET,douyin,ğŸ“º å›½å†…æµåª’ä½“            # æŠ–éŸ³
  - RULE-SET,kuaishou,ğŸ“º å›½å†…æµåª’ä½“          # å¿«æ‰‹
  - RULE-SET,tencentvideo,ğŸ“º å›½å†…æµåª’ä½“      # è…¾è®¯è§†é¢‘

  # åŸºç¡€è§„åˆ™
  - GEOIP,CN,ğŸ  å›½å†…ç›´è¿                   # å›½å†…IPç›´è¿
  - MATCH,ğŸš€ è‡ªåŠ¨ä»£ç†                      # å…¶ä½™æµé‡è‡ªåŠ¨ä»£ç†

# =====================
# è§„åˆ™è®¢é˜…é…ç½®
# =====================
rule-providers:
  bilibili:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/StreamingMedia/Video/bilibili.yaml"
    path: ./rules/bilibili.yaml
    interval: 86400

  douyin:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/StreamingMedia/Video/TikTok.yaml"
    path: ./rules/douyin.yaml
    interval: 86400

  kuaishou:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/StreamingMedia/Video/Kuaishou.yaml"
    path: ./rules/kuaishou.yaml
    interval: 86400

  tencentvideo:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/StreamingMedia/Video/è…¾è®¯è§†é¢‘.yaml"
    path: ./rules/tencentvideo.yaml
    interval: 86400

# =====================
# DNS é…ç½®
# =====================
dns:
  enable: true
  ipv6: true                   # å¯ç”¨IPv6è§£æ
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  nameserver:
    - https://dns.alidns.com/dns-query  # é˜¿é‡ŒDNS DoH
    - https://doh.pub/dns-query         # è…¾è®¯DNS DoH
  fallback:
    - tls://8.8.8.8:853        # Google DNS
    - tls://1.1.1.1:853        # Cloudflare DNS
  fallback-filter:
    geoip: true
    ipcidr:
      - 240.0.0.0/4
